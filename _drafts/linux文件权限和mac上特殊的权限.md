
# Linux 文件权限和 MacOSX 上特殊的权限

## 讲在前头

一般的，互联网相关的工作，如果 jd 上写了熟悉 Linux 开发，那么去面试（初中级）的时候肯定会问到文件权限相关的问题，我一度认为自己足够了解了，仔细看了下相关的资料，还差了一些距离，同时现在更换了开发环境，发现 MacOSX 的权限和 Linux 的文件权限有略微区别，就在此记录下来。

## Linux 文件权限的展示

通过 `ls -l` 输出结果，

```sh
drwxr-xr-x light staff  1.2 KB Fri Jul 19 14:58:12 2019   .
drwxr-xr-x light staff  816 B  Mon Jun 24 15:25:52 2019   ..
.rw-r--r-- light staff    8 KB Wed Feb 13 11:34:02 2019   .DS_Store
.rw-r--r-- light staff  3.1 KB Tue Jun 18 14:42:46 2019   2019-01-01-some-skills.md
.rw-r--r-- light staff  9.6 KB Tue Jun 18 14:42:55 2019   2019-01-02-单元测试浅析.md
.rw-r--r-- light staff  2.8 KB Tue Jun 18 14:43:12 2019   2019-01-03-argparse学习.md
```

可以看到输出结果最左边一列，类似于 `-rwxrwxrwx` 十个字符就是文件的权限信息。

第 1 个字符一般用来区分文件和目录，第 2～10 个字符是用来表示权限。

|第一个字符|说明|
|----|----|
|d|表示是一个目录，事实上在 ext2fs 中，目录是一个特殊的文件|
|－|表示这是一个普通的文件|
|l|表示这是一个符号链接文件，实际上它指向另一个文件|
|b、c|分别表示区块设备和其他的外围设备，是特殊类型的文件|
|s、p|这些文件关系到系统的数据结构和管道，通常很少见到|

## 一般权限

第 2～10 个字符当中的每 3 个为一组，左边 3 个字符表示`拥有者权限`，中间 3 个字符表示与 `所有者同一组的用户的权限`，右边 3 个字符是 `其他用户的权限`。这三个一组共 9 个字符，代表的意义如下：

|权限符号|说明|对应数值|对文件而言|对目录而言|
|------|----|-------|--------|--------|
|r|Read，读取|4|对文件而言，具有读取文件内容的权限|对目录来说，具有浏览目录的权限|
|w|Write,写入|2|对文件而言，具有新增、修改文件内容的权限|对目录来说，具有删除、移动目录内文件的权限|
|x|eXecute，执行|1|对文件而言，具有执行文件的权限|对目录了来说该用户具有进入目录的权限|
|－|表示不具有该项权限|0|-|-|

常见例子：

|权限|说明|
|----|----|
|-rwx------|文件所有者对文件具有读取、写入和执行的权限|
|-rwxr―r--|文件所有者具有读、写与执行的权限，其他用户则具有读取的权限|
|-rw-rw-r-x|文件所有者与同组用户对文件具有读写的权限，而其他用户仅具有读取和执行的权限|
|drwx--x--x|目录所有者具有读写与进入目录的权限,其他用户近能进入该目录，却无法读取任何数据|
|Drwx------|除了目录所有者具有完整的权限之外，其他用户对该目录完全没有任何权限|

每个用户都拥有自己的专属目录，通常集中放置在 /home 目录下，这些专属目录的默认权限为 drwx------，表示目录所有者本身具有所有权限，其他用户无法进入该目录。执行 mkdir 命令所创建的目录，其默认权限为 rwxr-xr-x,用户可以根据需要修改目录的权限。

此外，默认的权限可用 umask 命令修改，用法非常简单，只需执行 umask 777 命令，便代表屏蔽所有的权限，因而之后建立的文件或目录，其权限都变成 000，依次类推。通常 root 帐号搭配 umask 命令的数值为 022、027 和 077，普通用户则是采用 002，这样所产生的权限依次为 755、750、700、775。有关权限的数字表示法，后面将会详细说明。

## 附加权限

linux除了设置正常的读写操作权限外，还有关于一类设置也是涉及到权限，叫做Linxu附加权限。包括 SET位权限（suid，sgid）和粘滞位权限（sticky）。